{# automation/templates/partial/header.html #}
<header class="fixed top-0 right-0 left-0 md:left-72 z-50 h-14 border-b bg-white/80 backdrop-blur">
{% firstof collab.name colab.name request.user.get_full_name request.user.first_name request.user.username "visitante" as display_name %}

  <div class="mx-auto flex h-full max-w-7xl items-center gap-3 px-4">

    {# Mobile toggle #}
    <button class="size-9 inline-flex items-center justify-center rounded-lg hover:bg-slate-100 md:hidden"
            aria-label="Abrir menu" onclick="toggleSidebar()">
      <i data-lucide="menu" class="h-5 w-5"></i>
    </button>

   {# Saudação simples #}
<div class="ml-1 min-w-0 flex-1">
  <div class="min-w-0 flex items-center gap-2 text-sm">
    <span class="text-slate-600">Olá,</span>
    <strong class="truncate font-semibold text-slate-900" title="{{ display_name }}">
      {{ display_name }}
    </strong>
  </div>
</div>


    {# Ações à direita #}
    <div class="ml-auto flex items-center gap-2 sm:gap-3">

      {# Usuário: ícone + seta com dropdown ancorado #}
      <div class="relative">
        <button id="user-btn" type="button"
                class="inline-flex h-9 items-center gap-1 rounded-full border px-2.5 hover:bg-slate-100"
                aria-haspopup="menu" aria-expanded="false" aria-controls="user-menu">
          <i data-lucide="user-round" class="h-4 w-4"></i>
          <i data-lucide="chevron-down" class="h-4 w-4"></i>
          <span class="sr-only">Abrir menu do usuário</span>
        </button>

        {# --- DROPDOWN DO USUÁRIO --- #}
        <div id="user-menu"
             class="absolute right-0 top-full mt-2 hidden w-56 overflow-hidden rounded-xl bg-white text-slate-700 shadow-lg ring-1 ring-slate-900/5">
          <div class="px-3 py-2 text-xs text-slate-500">Conta</div>

          {# CONFIGURAÇÕES (opcional) #}
          {% url 'automation:settings' as settings_url %}
          {% if not settings_url %}{% url 'settings' as settings_url %}{% endif %}
          {% if settings_url %}
            <a href="{{ settings_url }}" class="flex items-center gap-2 px-3 py-2 hover:bg-slate-50">
              <i data-lucide="settings" class="h-4 w-4"></i> Configurações
            </a>
          {% endif %}

          <div class="h-px bg-slate-100"></div>

          {# LOGOUT (allauth ou auth padrão) #}
          {% url 'account_logout' as logout_url %}
          {% if not logout_url %}{% url 'logout' as logout_url %}{% endif %}
          {% if logout_url %}
            <form method="post" action="{{ logout_url }}">
              {% csrf_token %}
              <button type="submit"
                      class="flex w-full items-center gap-2 px-3 py-2 text-rose-700 hover:bg-rose-50">
                <i data-lucide="log-out" class="h-4 w-4"></i> Sair
              </button>
            </form>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</header>
